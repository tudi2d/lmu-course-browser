
import React from 'react';
import { Button } from '@/components/ui/button';
import { User, LogOut } from 'lucide-react';
import { supabase } from '@/integrations/supabase/client';
import { useEffect, useState } from 'react';
import { toast } from '@/components/ui/use-toast';
import {
  Dialog,
  DialogContent,
  DialogDescription,
  DialogFooter,
  DialogHeader,
  DialogTitle,
} from '@/components/ui/dialog';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuSeparator,
  DropdownMenuTrigger,
} from '@/components/ui/dropdown-menu';
import { Avatar, AvatarFallback } from '@/components/ui/avatar';
import { useIsMobile } from '@/hooks/use-mobile';

const Navbar = () => {
  const [user, setUser] = useState<any>(null);
  const [authDialogOpen, setAuthDialogOpen] = useState(false);
  const [email, setEmail] = useState("");
  const [password, setPassword] = useState("");
  const [isSignUp, setIsSignUp] = useState(false);
  const [authLoading, setAuthLoading] = useState(false);
  const [authError, setAuthError] = useState("");
  const [authProvider, setAuthProvider] = useState<'email' | 'google' | 'apple'>('email');
  
  const isMobile = useIsMobile();

  useEffect(() => {
    supabase.auth.getSession().then(({ data: { session } }) => {
      setUser(session?.user || null);
    });

    const { data: { subscription } } = supabase.auth.onAuthStateChange(
      (event, session) => {
        setUser(session?.user || null);
        
        if (event === 'SIGNED_IN') {
          toast({
            title: "Welcome back!",
            description: "You have successfully signed in.",
          });
        }
        
        if (event === 'SIGNED_OUT') {
          toast({
            title: "Signed out",
            description: "You have been signed out.",
          });
        }
      }
    );

    return () => {
      subscription.unsubscribe();
    };
  }, []);

  const handleSignIn = async (e: React.FormEvent) => {
    e.preventDefault();
    setAuthLoading(true);
    setAuthError("");
    
    try {
      if (isSignUp) {
        const { error } = await supabase.auth.signUp({
          email,
          password,
        });
        
        if (error) throw error;
        
        toast({
          title: "Account created",
          description: "Please check your email to verify your account.",
        });
      } else {
        const { error } = await supabase.auth.signInWithPassword({
          email,
          password,
        });
        
        if (error) throw error;
      }
      
      setAuthDialogOpen(false);
    } catch (error: any) {
      console.error("Authentication error:", error);
      setAuthError(error.message || "Authentication failed");
    } finally {
      setAuthLoading(false);
    }
  };

  const handleSignInWithProvider = async (provider: 'google' | 'apple') => {
    try {
      setAuthError("");
      setAuthProvider(provider);
      
      const { error } = await supabase.auth.signInWithOAuth({
        provider,
        options: {
          redirectTo: window.location.origin,
        },
      });
      
      if (error) throw error;
      
      // Dialog will be closed when the OAuth redirect completes
    } catch (error: any) {
      console.error(`${provider} authentication error:`, error);
      setAuthError(error.message || `${provider} authentication failed`);
    }
  };

  const handleSignOut = async () => {
    await supabase.auth.signOut();
  };

  return (
    <nav className="border-b border-slate-200 py-3 px-4 bg-white">
      <div className="container mx-auto flex justify-between items-center">
        <h1 className="text-lg font-bold tracking-tight text-black">lmu course browser</h1>
        
        {user ? (
          <DropdownMenu>
            <DropdownMenuTrigger asChild>
              <Avatar className="h-8 w-8 cursor-pointer">
                <AvatarFallback>{user.email?.charAt(0).toUpperCase()}</AvatarFallback>
              </Avatar>
            </DropdownMenuTrigger>
            <DropdownMenuContent align="end">
              <div className="px-2 py-1.5 text-sm font-medium">{user.email}</div>
              <DropdownMenuSeparator />
              <DropdownMenuItem onClick={handleSignOut} className="cursor-pointer">
                <LogOut className="mr-2 h-4 w-4" />
                Sign out
              </DropdownMenuItem>
            </DropdownMenuContent>
          </DropdownMenu>
        ) : (
          <Button 
            variant="outline" 
            size={isMobile ? "icon" : "sm"} 
            onClick={() => setAuthDialogOpen(true)}
            className="whitespace-nowrap"
            aria-label="Sign In"
          >
            <User className={isMobile ? "h-4 w-4" : "mr-2 h-4 w-4"} />
            {!isMobile && "Sign In"}
          </Button>
        )}
      </div>

      <Dialog open={authDialogOpen} onOpenChange={setAuthDialogOpen}>
        <DialogContent className="sm:max-w-md">
          <DialogHeader>
            <DialogTitle>{isSignUp ? "Create Account" : "Sign In"}</DialogTitle>
            <DialogDescription>
              {isSignUp 
                ? "Create a new account to save your favorite courses" 
                : "Sign in to your account to access your favorites"}
            </DialogDescription>
          </DialogHeader>
          
          <form onSubmit={handleSignIn} className="space-y-4">
            <div className="space-y-2">
              <Label htmlFor="email">Email</Label>
              <Input
                id="email"
                type="email"
                value={email}
                onChange={(e) => setEmail(e.target.value)}
                placeholder="your.email@example.com"
                required
              />
            </div>
            
            <div className="space-y-2">
              <Label htmlFor="password">Password</Label>
              <Input
                id="password"
                type="password"
                value={password}
                onChange={(e) => setPassword(e.target.value)}
                placeholder="••••••••"
                required
              />
            </div>
            
            {authError && (
              <div className="text-destructive text-sm">{authError}</div>
            )}
            
            <div className="flex flex-col gap-2">
              <Button 
                type="button" 
                variant="outline" 
                onClick={() => handleSignInWithProvider('google')}
                disabled={authLoading}
                className="flex items-center justify-center gap-2"
              >
                <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24" className="h-4 w-4">
                  <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4"/>
                  <path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"/>
                  <path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"/>
                  <path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"/>
                  <path d="M1 1h22v22H1z" fill="none"/>
                </svg>
                Continue with Google
              </Button>
              
              <Button 
                type="button" 
                variant="outline" 
                onClick={() => handleSignInWithProvider('apple')}
                disabled={authLoading}
                className="flex items-center justify-center gap-2"
              >
                <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24" className="h-4 w-4">
                  <path d="M16.36 1C15.05 1 13.88 1.7 13.17 2.42C12.52 3.08 12 4.03 12 5.03C12 5.2 12.02 5.36 12.04 5.52C12.09 5.86 12.19 6.18 12.32 6.47C12.63 7.12 13.07 7.68 13.61 8.07C14.15 8.46 14.77 8.65 15.4 8.65C16.52 8.65 17.55 8.05 18.24 7.37C18.77 6.83 19.23 6.08 19.23 5.03C19.23 3.54 17.89 1 16.36 1Z" fill="none" stroke="currentColor" strokeWidth="1.5"/>
                  <path d="M19.36 10.73C19.13 10.7 18.88 10.75 18.63 10.89C18.38 11.03 18.13 11.22 17.89 11.46C17.64 11.69 17.4 11.98 17.17 12.32C16.94 12.65 16.73 13.03 16.53 13.46C16.31 13.93 16.11 14.44 15.92 14.99C15.72 15.54 15.54 16.13 15.38 16.75C15.22 17.37 15.08 18.02 14.96 18.7C14.85 19.38 14.75 20.09 14.68 20.81C14.61 21.54 14.56 22.28 14.53 23.03H19.29C19.33 22.52 19.37 22.01 19.42 21.5C19.47 20.99 19.53 20.49 19.6 19.98C19.66 19.47 19.74 18.96 19.82 18.45C19.91 17.94 20 17.44 20.11 16.93C20.22 16.42 20.34 15.91 20.48 15.4C20.61 14.89 20.75 14.39 20.91 13.88C21.06 13.37 21.25 12.85 21.44 12.34C21.64 11.83 21.85 11.32 22.09 10.81C21.93 10.76 21.77 10.73 21.61 10.73H19.36Z" fill="currentColor"/>
                  <path d="M4.74 10.73C4.5 10.7 4.26 10.75 4.02 10.89C3.77 11.03 3.52 11.22 3.27 11.46C3.02 11.69 2.79 11.98 2.56 12.32C2.32 12.65 2.11 13.03 1.91 13.46C1.7 13.93 1.5 14.44 1.3 14.99C1.1 15.54 0.93 16.13 0.77 16.75C0.6 17.37 0.46 18.02 0.34 18.7C0.23 19.38 0.14 20.09 0.06 20.81C-0.01 21.54 -0.05 22.28 -0.08 23.03H4.67C4.7 22.52 4.75 22.01 4.8 21.5C4.85 20.99 4.91 20.49 4.97 19.98C5.04 19.47 5.11 18.96 5.2 18.45C5.28 17.94 5.37 17.44 5.48 16.93C5.59 16.42 5.72 15.91 5.85 15.4C5.98 14.89 6.13 14.39 6.28 13.88C6.43 13.37 6.63 12.85 6.82 12.34C7.01 11.83 7.23 11.32 7.46 10.81C7.3 10.76 7.14 10.73 6.98 10.73H4.74Z" fill="currentColor"/>
                  <path d="M11.39 10.73C11.13 10.73 10.87 10.78 10.6 10.89C10.33 11 10.06 11.16 9.8 11.37C9.54 11.58 9.28 11.83 9.03 12.12C8.78 12.41 8.54 12.73 8.31 13.09C8.11 13.39 7.92 13.71 7.74 14.04C7.57 14.38 7.4 14.72 7.25 15.08C7.09 15.44 6.96 15.8 6.83 16.18C6.7 16.56 6.58 16.94 6.48 17.34C6.38 17.73 6.29 18.14 6.22 18.55C6.15 18.96 6.08 19.38 6.04 19.8C5.99 20.22 5.95 20.65 5.93 21.09C5.9 21.52 5.89 21.97 5.89 22.42C5.89 22.63 5.89 22.83 5.9 23.03H13.74C13.74 22.82 13.75 22.62 13.75 22.42C13.75 21.99 13.74 21.57 13.73 21.15C13.71 20.73 13.69 20.33 13.66 19.93C13.63 19.53 13.59 19.13 13.53 18.75C13.48 18.37 13.42 17.98 13.35 17.61C13.28 17.23 13.19 16.86 13.1 16.5C13 16.13 12.9 15.77 12.79 15.41C12.67 15.06 12.55 14.71 12.41 14.36C12.28 14.02 12.13 13.68 11.97 13.34C11.81 13.01 11.64 12.68 11.46 12.35C11.27 12.03 11.07 11.72 10.86 11.41C10.64 11.11 10.41 10.85 10.16 10.64C9.91 10.42 9.64 10.25 9.36 10.13C9.07 10.01 8.79 9.94 8.5 9.94H8.49C8.2 9.94 7.92 10 7.63 10.13C7.34 10.25 7.08 10.42 6.82 10.64C6.57 10.85 6.34 11.11 6.12 11.41C5.9 11.72 5.71 12.03 5.52 12.35C5.33 12.68 5.16 13.01 5 13.34C4.85 13.68 4.69 14.02 4.56 14.36C4.42 14.71 4.3 15.06 4.19 15.41C4.07 15.77 3.97 16.13 3.87 16.5C3.78 16.86 3.69 17.23 3.62 17.61C3.55 17.98 3.48 18.37 3.43 18.75C3.38 19.13 3.33 19.53 3.3 19.93C3.27 20.33 3.25 20.73 3.23 21.15C3.22 21.57 3.21 21.99 3.21 22.42C3.21 22.63 3.21 22.83 3.22 23.03H5.89C5.89 22.38 5.95 21.75 6.08 21.13C6.21 20.52 6.39 19.93 6.62 19.35C6.86 18.78 7.13 18.22 7.45 17.69C7.77 17.15 8.12 16.65 8.5 16.18C8.88 16.65 9.22 17.15 9.54 17.69C9.86 18.22 10.13 18.78 10.37 19.35C10.6 19.93 10.78 20.52 10.91 21.13C11.04 21.75 11.1 22.38 11.1 23.03H13.74C13.74 21.87 13.61 20.73 13.34 19.6C13.07 18.48 12.67 17.38 12.15 16.31C11.62 15.24 10.97 14.23 10.19 13.28C9.65 12.62 9.07 12.09 8.47 11.67C8.16 11.47 7.85 11.31 7.53 11.18C7.22 11.06 6.9 11 6.59 11C6.28 11 5.98 11.06 5.69 11.19C5.4 11.32 5.12 11.5 4.86 11.71C4.6 11.93 4.36 12.18 4.15 12.47C3.93 12.76 3.75 13.07 3.59 13.39L4.26 13.71C4.42 13.4 4.6 13.11 4.8 12.83C5 12.56 5.21 12.31 5.45 12.09C5.69 11.87 5.94 11.68 6.21 11.55C6.48 11.41 6.76 11.34 7.05 11.34C7.34 11.34 7.62 11.41 7.88 11.55C8.15 11.68 8.4 11.87 8.64 12.09C8.88 12.31 9.1 12.56 9.3 12.83C9.5 13.11 9.68 13.4 9.84 13.71L10.51 13.39C10.36 13.07 10.17 12.76 9.96 12.47C9.74 12.18 9.5 11.93 9.24 11.71C8.98 11.5 8.7 11.32 8.41 11.19C8.12 11.06 7.82 11 7.51 11C7.2 11 6.88 11.06 6.57 11.18C6.25 11.31 5.94 11.47 5.63 11.67C5.03 12.09 4.45 12.62 3.91 13.28C3.13 14.23 2.48 15.24 1.95 16.31C1.43 17.38 1.03 18.48 0.76 19.6C0.49 20.73 0.36 21.87 0.36 23.03H3C3 21.99 3.14 20.96 3.43 19.95C3.72 18.94 4.13 17.97 4.68 17.04C5.23 16.11 5.89 15.24 6.68 14.44C7.28 13.83 7.93 13.35 8.62 13C8.87 12.88 9.13 12.79 9.39 12.74C9.66 12.69 9.92 12.68 10.18 12.7H10.19C10.46 12.68 10.73 12.69 11 12.74C11.27 12.79 11.53 12.88 11.78 13C12.46 13.35 13.11 13.83 13.71 14.44C14.5 15.24 15.16 16.11 15.71 17.04C16.26 17.97 16.67 18.94 16.96 19.95C17.25 20.96 17.39 21.99 17.39 23.03H19.39V22.97C19.39 21.83 19.26 20.71 19 19.59C18.74 18.48 18.35 17.4 17.83 16.34C17.31 15.29 16.67 14.28 15.9 13.33C15.13 12.37 14.23 11.51 13.22 10.75C12.66 10.33 12.08 10.04 11.5 9.87C11.22 9.79 10.93 9.75 10.65 9.75C10.36 9.75 10.08 9.79 9.8 9.87C9.52 9.96 9.25 10.07 8.98 10.23C8.72 10.38 8.47 10.56 8.23 10.75C7.99 10.95 7.77 11.16 7.56 11.38C7.35 11.61 7.15 11.84 6.98 12.09L7.65 12.41C7.8 12.19 7.96 11.99 8.13 11.79C8.31 11.59 8.49 11.41 8.67 11.25C8.86 11.09 9.05 10.96 9.25 10.85C9.44 10.75 9.63 10.7 9.82 10.7C10.01 10.7 10.2 10.75 10.39 10.85C10.59 10.96 10.78 11.09 10.97 11.25C11.16 11.41 11.34 11.59 11.51 11.79C11.69 11.99 11.85 12.19 12 12.41L12.67 12.09C12.49 11.84 12.3 11.61 12.09 11.38C11.87 11.16 11.65 10.95 11.41 10.75C11.17 10.56 10.92 10.38 10.66 10.23C10.39 10.07 10.12 9.96 9.84 9.87C9.56 9.79 9.28 9.75 8.99 9.75C8.71 9.75 8.42 9.79 8.14 9.87C7.56 10.04 6.98 10.33 6.42 10.75C5.41 11.51 4.51 12.37 3.74 13.33C2.97 14.28 2.33 15.29 1.81 16.34C1.29 17.4 0.9 18.48 0.64 19.59C0.38 20.71 0.25 21.83 0.25 22.97V23.03H3.22C3.22 21.78 3.36 20.55 3.65 19.35C3.93 18.15 4.33 16.99 4.86 15.88C5.39 14.77 6.03 13.73 6.78 12.77C7.54 11.8 8.4 10.93 9.36 10.15C9.69 9.91 10.03 9.73 10.39 9.6C10.57 9.54 10.75 9.5 10.94 9.49C11.13 9.48 11.32 9.5 11.51 9.54C11.71 9.58 11.9 9.64 12.09 9.73C12.28 9.82 12.47 9.93 12.65 10.07C13.01 10.33 13.34 10.65 13.64 11.02C13.95 11.38 14.23 11.78 14.48 12.22C14.73 12.65 14.96 13.13 15.16 13.63C15.36 14.13 15.54 14.66 15.7 15.21C15.85 15.77 15.99 16.34 16.1 16.93C16.21 17.52 16.3 18.12 16.37 18.73C16.44 19.35 16.49 19.97 16.52 20.6C16.55 21.23 16.57 21.87 16.57 22.5C16.57 22.68 16.57 22.85 16.56 23.03H22.09C22.09 21.97 21.95 20.93 21.67 19.91C21.39 18.9 20.99 17.93 20.46 17C19.93 16.06 19.29 15.18 18.54 14.36C17.79 13.54 16.94 12.8 16.01 12.14C15.45 11.74 14.87 11.44 14.28 11.24C13.69 11.04 13.09 10.94 12.49 10.94H12.48C12.15 10.94 11.82 10.97 11.49 11.05C11.17 11.13 10.85 11.24 10.55 11.38C10.25 11.53 9.96 11.7 9.69 11.91C9.42 12.12 9.17 12.36 8.94 12.62C8.71 12.87 8.5 13.15 8.31 13.44L8.98 13.76C9.16 13.5 9.36 13.26 9.58 13.03C9.8 12.81 10.03 12.61 10.27 12.44C10.52 12.28 10.78 12.14 11.04 12.05C11.3 11.96 11.58 11.92 11.86 11.92C12.35 11.92 12.84 12.01 13.32 12.19C13.8 12.37 14.27 12.63 14.73 12.97C15.61 13.57 16.4 14.28 17.12 15.08C17.83 15.88 18.45 16.76 18.97 17.69C19.49 18.62 19.91 19.61 20.23 20.65C20.54 21.69 20.75 22.75 20.84 23.84H22.53V23.78C22.53 22.51 22.39 21.27 22.11 20.06C21.83 18.86 21.44 17.69 20.93 16.57C20.43 15.45 19.82 14.39 19.1 13.4C18.39 12.41 17.58 11.5 16.68 10.73C16.44 10.54 16.2 10.37 15.95 10.2C15.71 10.04 15.47 9.9 15.22 9.77C14.97 9.64 14.72 9.54 14.47 9.45C14.22 9.36 13.96 9.31 13.71 9.28C13.46 9.25 13.21 9.25 12.96 9.27C12.71 9.29 12.47 9.33 12.23 9.39C12 9.45 11.77 9.53 11.54 9.63C11.32 9.73 11.1 9.84 10.89 9.97C10.47 10.23 10.08 10.54 9.73 10.88C9.38 11.22 9.05 11.59 8.77 11.98C8.48 12.37 8.23 12.79 8.01 13.21C7.8 13.64 7.62 14.07 7.48 14.51C7.34 14.95 7.23 15.39 7.16 15.82C7.09 16.26 7.06 16.69 7.06 17.1C7.06 17.52 7.1 17.92 7.17 18.31C7.24 18.71 7.35 19.08 7.49 19.44C7.63 19.8 7.8 20.13 8 20.45C8.2 20.77 8.43 21.06 8.67 21.33C8.92 21.6 9.19 21.84 9.48 22.06C9.76 22.27 10.07 22.46 10.38 22.61C10.69 22.76 11.02 22.88 11.36 22.97C11.7 23.06 12.05 23.1 12.4 23.1C12.62 23.1 12.83 23.08 13.04 23.03H14.53C14.56 22.28 14.61 21.54 14.68 20.81C14.75 20.09 14.85 19.38 14.96 18.7C15.08 18.02 15.22 17.37 15.38 16.75C15.54 16.13 15.72 15.54 15.92 14.99C16.11 14.44 16.31 13.93 16.53 13.46C16.73 13.03 16.94 12.65 17.17 12.32C17.4 11.98 17.64 11.69 17.89 11.46C18.13 11.22 18.38 11.03 18.63 10.89C18.88 10.75 19.13 10.7 19.36 10.73H21.61C21.77 10.73 21.93 10.76 22.09 10.81C21.85 11.32 21.64 11.83 21.44 12.34C21.25 12.85 21.06 13.37 20.91 13.88C20.75 14.39 20.61 14.89 20.48 15.4C20.34 15.91 20.22 16.42 20.11 16.93C20 17.44 19.91 17.94 19.82 18.45C19.74 18.96 19.66 19.47 19.6 19.98C19.53 20.49 19.47 20.99 19.42 21.5C19.37 22.01 19.33 22.52 19.29 23.03H14.53C14.56 22.28 14.61 21.54 14.68 20.81C14.75 20.09 14.85 19.38 14.96 18.7C15.08 18.02 15.22 17.37 15.38 16.75C15.54 16.13 15.72 15.54 15.92 14.99C16.11 14.44 16.31 13.93 16.53 13.46C16.73 13.03 16.94 12.65 17.17 12.32C17.4 11.98 17.64 11.69 17.89 11.46C18.13 11.22 18.38 11.03 18.63 10.89C18.88 10.75 19.13 10.7 19.36 10.73H21.61C21.77 10.73 21.93 10.76 22.09 10.81C21.85 11.32 21.64 11.83 21.44 12.34C21.25 12.85 21.06 13.37 20.91 13.88C20.75 14.39 20.61 14.89 20.48 15.4C20.34 15.91 20.22 16.42 20.11 16.93C20 17.44 19.91 17.94 19.82 18.45C19.74 18.96 19.66 19.47 19.6 19.98C19.53 20.49 19.47 20.99 19.42 21.5C19.37 22.01 19.33 22.52 19.29 23.03H6.98C6.98 22.83 6.98 22.63 6.98 22.42C6.98 21.97 6.99 21.52 7.02 21.09C7.04 20.65 7.08 20.22 7.13 19.8C7.17 19.38 7.24 18.96 7.31 18.55C7.38 18.14 7.47 17.73 7.57 17.34C7.67 16.94 7.79 16.56 7.92 16.18C8.05 15.8 8.18 15.44 8.34 15.08C8.49 14.72 8.66 14.38 8.83 14.04C9.01 13.71 9.2 13.39 9.4 13.09C9.63 12.73 9.87 12.41 10.12 12.12C10.37 11.83 10.63 11.58 10.89 11.37C11.15 11.16 11.42 11 11.69 10.89C11.96 10.78 12.22 10.73 12.48 10.73H10.19C9.92 10.73 9.66 10.69 9.39 10.74C9.13 10.79 8.87 10.88 8.62 11C7.93 11.35 7.28 11.83 6.68 12.44C5.89 13.24 5.23 14.11 4.68 15.04C4.13 15.97 3.72 16.94 3.43 17.95C3.14 18.96 3 19.99 3 21.03V23.03H13.74C13.74 22.83 13.74 22.63 13.74 22.42C13.74 21.97 13.73 21.52 13.71 21.09C13.69 20.65 13.65 20.22 13.6 19.8C13.56 19.38 13.49 18.96 13.42 18.55C13.35 18.14 13.26 17.73 13.16 17.34C13.06 16.94 12.94 16.56 12.81 16.18C12.68 15.8 12.55 15.44 12.39 15.08C12.24 14.72 12.07 14.38 11.9 14.04C11.72 13.71 11.53 13.39 11.33 13.09C11.1 12.73 10.86 12.41 10.61 12.12C10.36 11.83 10.1 11.58 9.84 11.37C9.58 11.16 9.31 11 9.04 10.89C8.77 10.78 8.51 10.73 8.25 10.73H12.48C12.74 10.73 13 10.78 13.27 10.89C13.54 11 13.8 11.16 14.06 11.37C14.32 11.58 14.58 11.83 14.83 12.12C15.08 12.41 15.32 12.73 15.55 13.09C15.75 13.39 15.94 13.71 16.12 14.04C16.29 14.38 16.46 14.72 16.61 15.08C16.77 15.44 16.9 15.8 17.03 16.18C17.16 16.56 17.28 16.94 17.38 17.34C17.48 17.73 17.57 18.14 17.64 18.55C17.71 18.96 17.78 19.38 17.82 19.8C17.87 20.22 17.91 20.65 17.93 21.09C17.95 21.52 17.96 21.97 17.96 22.42C17.96 22.63 17.96 22.83 17.95 23.03H22.09C22.09 22.82 22.09 22.62 22.09 22.42C22.09 21.97 22.08 21.52 22.06 21.09C22.04 20.65 22 20.22 21.95 19.8C21.91 19.38 21.84 18.96 21.77 18.55C21.7 18.14 21.61 17.73 21.51 17.34C21.41 16.94 21.29 16.56 21.16 16.18C21.03 15.8 20.9 15.44 20.74 15.08C20.59 14.72 20.42 14.38 20.25 14.04C20.07 13.71 19.88 13.39 19.68 13.09C19.45 12.73 19.21 12.41 18.96 12.12C18.71 11.83 18.45 11.58 18.19 11.37C17.93 11.16 17.66 11 17.39 10.89C17.12 10.78 16.86 10.73 16.6 10.73H8.49C8.79 10.73 9.07 10.8 9.36 10.93C9.64 11.05 9.91 11.22 10.16 11.43C10.41 11.64 10.64 11.9 10.86 12.2C11.07 12.51 11.27 12.82 11.46 13.14C11.64 13.47 11.81 13.8 11.97 14.14C12.13 14.48 12.28 14.82 12.41 15.17C12.55 15.52 12.67 15.87 12.79 16.22C12.9 16.58 13 16.94 13.1 17.31C13.19 17.67 13.28 18.04 13.35 18.42C13.42 18.79 13.48 19.18 13.53 19.56C13.59 19.94 13.63 20.34 13.66 20.74C13.69 21.14 13.71 21.55 13.73 21.96C13.74 22.38 13.75 22.8 13.75 23.23C13.75 23.43 13.74 23.63 13.74 23.84H5.9C5.89 23.63 5.89 23.43 5.89 23.23C5.89 22.8 5.9 22.38 5.93 21.96C5.95 21.55 5.99 21.14 6.04 20.74C6.08 20.34 6.15 19.94 6.22 19.56C6.29 19.18 6.38 18.79 6.48 18.42C6.58 18.04 6.7 17.67 6.83 17.31C6.96 16.94 7.09 16.58 7.25 16.22C7.4 15.87 7.57 15.52 7.74 15.17C7.92 14.82 8.11 14.48 8.31 14.14C8.54 13.8 8.78 13.47 9.03 13.14C9.28 12.82 9.54 12.51 9.8 12.2C10.06 11.9 10.33 11.64 10.6 11.43C10.87 11.22 11.13 11.05 11.39 10.93C11.65 10.8 11.9 10.73 12.14 10.73C12.38 10.73 12.62 10.8 12.86 10.93C13.09 11.05 13.31 11.22 13.53 11.43C13.75 11.64 13.95 11.9 14.15 12.2C14.35 12.51 14.54 12.82 14.73 13.14C14.91 13.47 15.08 13.8 15.25 14.14C15.41 14.48 15.57 14.82 15.72 15.17C15.87 15.52 16.01 15.87 16.14 16.22C16.27 16.58 16.39 16.94 16.51 17.31C16.62 17.67 16.72 18.04 16.81 18.42C16.9 18.79 16.98 19.18 17.05 19.56C17.12 19.94 17.18 20.34 17.24 20.74C17.29 21.14 17.33 21.55 17.36 21.96C17.39 22.38 17.42 22.8 17.43 23.23C17.44 23.43 17.44 23.63 17.44 23.84H17.39C17.39 23.63 17.39 23.43 17.39 23.23C17.39 22.8 17.38 22.38 17.35 21.96C17.33 21.55 17.29 21.14 17.24 20.74C17.19 20.34 17.12 19.94 17.05 19.56C16.98 19.18 16.89 18.79 16.79 18.42C16.69 18.04 16.57 17.67 16.44 17.31C16.31 16.94 16.18 16.58 16.02 16.22C15.87 15.87 15.7 15.52 15.53 15.17C15.35 14.82 15.16 14.48 14.95 14.14C14.75 13.8 14.54 13.47 14.31 13.14C14.09 12.82 13.85 12.51 13.61 12.2C13.37 11.9 13.11 11.64 12.85 11.43C12.59 11.22 12.32 11.05 12.04 10.93C11.77 10.8 11.49 10.73 11.2 10.73C10.91 10.73 10.63 10.8 10.35 10.93C10.07 11.05 9.81 11.22 9.55 11.43C9.29 11.64 9.04 11.9 8.8 12.2C8.56 12.51 8.33 12.82 8.1 13.14C7.87 13.47 7.65 13.8 7.45 14.14C7.24 14.48 7.05 14.82 6.86 15.17C6.68 15.52 6.51 15.87 6.35 16.22C6.19 16.58 6.04 16.94 5.9 17.31C5.76 17.67 5.64 18.04 5.52 18.42C5.41 18.79 5.31 19.18 5.22 19.56C5.13 19.94 5.05 20.34 4.98 20.74C4.91 21.14 4.85 21.55 4.8 21.96C4.75 22.38 4.7 22.8 4.67 23.23C4.64 23.43 4.64 23.63 4.64 23.84H3.22C3.22 23.2 3.27 22.58 3.38 21.97C3.49 21.36 3.65 20.77 3.86 20.2C4.07 19.62 4.32 19.07 4.63 18.54C4.93 18.01 5.28 17.5 5.68 17.02C6.08 16.55 6.51 16.1 6.98 15.68C7.45 15.27 7.96 14.89 8.5 14.56C9.04 14.89 9.55 15.27 10.02 15.68C10.49 16.1 10.92 16.55 11.32 17.02C11.72 17.5 12.07 18.01 12.37 18.54C12.68 19.07 12.93 19.62 13.14 20.2C13.35 20.77 13.51 21.36 13.62 21.97C13.73 22.58 13.78 23.2 13.78 23.84H5.9C5.9 23.63 5.9 23.43 5.9 23.23C5.9 22.8 5.91 22.38 5.94 21.96C5.96 21.55 6 21.14 6.05 20.74C6.09 20.34 6.16 19.94 6.23 19.56C6.3 19.18 6.39 18.79 6.49 18.42C6.59 18.04 6.71 17.67 6.84 17.31C6.97 16.94 7.1 16.58 7.26 16.22C7.41 15.87 7.58 15.52 7.75 15.17C7.93 14.82 8.12 14.48 8.32 14.14C8.55 13.8 8.79 13.47 9.04 13.14C9.29 12.82 9.55 12.51 9.81 12.2C10.07 11.9 10.34 11.64 10.61 11.43C10.88 11.22 11.14 11.05 11.4 10.93C11.66 10.8 11.91 10.73 12.15 10.73H11.39Z" fill="currentColor"/>
                </svg>
                Continue with Apple
              </Button>
            </div>
            
            <DialogFooter className="flex flex-col sm:flex-row gap-2 sm:justify-between sm:space-x-0">
              <Button 
                type="button" 
                variant="outline" 
                onClick={() => setIsSignUp(!isSignUp)}
                disabled={authLoading}
              >
                {isSignUp ? "Already have an account?" : "Need an account?"}
              </Button>
              
              <Button type="submit" disabled={authLoading}>
                {authLoading ? "Processing..." : isSignUp ? "Sign Up" : "Sign In"}
              </Button>
            </DialogFooter>
          </form>
        </DialogContent>
      </Dialog>
    </nav>
  );
};

export default Navbar;
